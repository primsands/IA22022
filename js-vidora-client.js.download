!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=188)}({188:function(e,t,i){var n=i(189),r=[".storyblock_title_link",".storyblock_image_link",".related-content_link",".user-recommendation .tge-cardv2_wrapper"],o=document.createElement("script");o.src="https://assets.vidora.com/js/vidora-client.1.x.x.min.js",o.async=!0,document.querySelectorAll("head")[0].append(o);var a=function(){n.initVidora(),n.sendPageView(),n.initElements(r.join(", ")),window.vidoraTrackExtraElements=function(){return n.trackExtraItems()}},s=function(){window.vidoraHelper=n};!function e(){newscorpau&&newscorpau.site&&newscorpau.environment?(a(),s()):setTimeout(e,500)}()},189:function(e,t,i){var n=i(54),r=i(190),o=i(191),a=i(66),s=n.getCookie;e.exports={registeredLinks:[],querySelector:"",vidoraAPI:null,isSubscriber:function(){var e=document.body.getAttribute("data-access-level"),t=s("subscriber_token"),i=t?decodeURI(t):void 0,n=!!i&&JSON.parse(i).entitlements;return"subscriber"===e||n?1:0},initVidora:function(){var e,t,i,n,o="prod"===newscorpau.environment?"":"___dev",a=newscorpau.site.toLowerCase(),s=r.keyMap[a]+o;e=window,document,t="vidora",i=s,(n={_q:[]}).ready=n.push=function(e){n._q.push(e)},t in e||(e[t]=n),e[t].ready((function(e,t){t._i(i,void 0)}))},sendPageView:function(){var e=newscorpau.articleID,t=this.isSubscriber();if(window.location.pathname.includes("/news-story/")){var i=s("metrics_pcsid");i&&""!==i&&"not%20set"!==i&&window.vidora.push(["setUserId",i]),window.vidora.push(["send","page_view",e,{params:{cookie_id:s("_ncg_id_"),is_subscriber:t}}])}},initElements:function(e){var t=document.querySelectorAll(e);this.querySelector=e;var i=this;i.updateRegisteredLinks(t),window.vidora.ready((function(e){var n=s("metrics_pcsid");i.vidoraAPI=e,n&&""!==n&&"not%20set"!==n&&e.setUserId(n),t.forEach((function(e){i.initNode(e)})),console.log("%c Vidora API finished initializing!","background: #222; color: #b9da52")}))},initNode:function(e){var t=this.extractId(e),i=this.isSubscriber();this.attachClickListener(e,t),a.watch(e,this.vidoraAPI,i)},extractId:function(e){var t=e.href;return t&&t.slice(Math.max(0,t.lastIndexOf("/")+1))},attachClickListener:function(e,t){var i=this.getClickParams(e),n=this.vidoraAPI,r=this.isSubscriber();e.addEventListener("click",function(e,t){return function(o){o.preventDefault(),n.send("click",e,{params:{cookie_id:i.ncgID,position:i.position,group_id:i.group_id,is_subscriber:r}}),window.location=t}}(t,i.link))},getClickParams:function(e){var t=s("_ncg_id_"),i=e.hostname,n=e.getAttribute("href"),r=e.getAttribute("data-tgev-order"),o=i&&i.split(".")[1],a=n.split("/")[3],c=e.getAttribute("data-group-id"),d=c?o+"_"+c:o+"_"+a;return"recommended-for-you"===e.getAttribute("data-tgev-container")&&(d=o+"_recommended-for-you-"+newscorpau.pagetype),{cookie_id:t,position:r,group_id:d,link:n}},updateRegisteredLinks:function(e){var t=this;e.forEach((function(e){var i=e.href;t.registeredLinks.includes(i)||t.registeredLinks.push(i)}))},trackExtraItems:function(){var e=this,t=document.querySelectorAll(this.querySelector),i=this;window.vidora.ready((function(){t.forEach((function(e){var t=e.href||"";i.registeredLinks.includes(t)||i.initNode(e)})),e.updateRegisteredLinks(t)}))},trackFollowButton:function(e){var t=this;window.vidora.ready((function(){o(e,t.isSubscriber(),t.vidoraAPI).init()}))}}},190:function(e,t){t.keyMap={cairnspost:"cairnspost.EE49890881E7053469BD6E410C03D747",geelongadvertiser:"geelongadvertiser.CA5411A8D846BCF3996B6A31FEF2CCF9",goldcoastbulletin:"goldcoastbulletin.A433DB834E6BF3BD775EE9A00D353230",ntnews:"ntnews.9C972E00C7E98E2C523A93943EE85752",mercury:"themercury.02C29402595888AA1F35CA8969248925",weeklytimesnow:"weeklytimesnow.F784F1C5B7C1CF927A9B78A85BB10222",townsvillebulletin:"townsvillebulletin.6E1F1ADC95C155164BABB9B58CEED0A1",adelaidenow:"adelaide_advertiser.7C7FF7CA84DB1A67F44F9CF6566A7F7E",couriermail:"couriermail.86A83FC34FE5C7098A2D40AD3E923D9B",dailytelegraph:"dailytelegraph.ED76B39B872C754B916B7D770AA8BBEC",heraldsun:"heraldsun.2F8773CE626E38E3517E704E87B6D52D",thechronicle:"toowoomba_chronicle.ACDA865851F032E418E841F86EAFECA4"}},191:function(e,t,i){var n=i(54),r=i(66),o=n.getCookie;e.exports=function(e,t,i){return{init:function(){e.dataset.listener||(this.attachClickListener(),r.watch(e,i,t))},attachClickListener:function(){var n=this.getParams();e.dataset.listener=!0,e.addEventListener("click",(function(r){r.preventDefault(),i.send(e.dataset.label,"",{params:{cookie_id:n.ncgID,position:n.position,group_id:n.group_id,is_subscriber:t,category_name:n.categoryName}})}))},getParams:function(){var t=o("_ncg_id_"),i=e.dataset.order,n=e.parentNode.dataset.vidoraid,r=e.parentNode.dataset.followedfromdomain,a=r&&r.split(".")[0],s=e.getAttribute("data-group-id");return{cookie_id:t,position:i,group_id:s?a+"_"+s:a+"_category-follow-recommendations",categoryName:n}}}}},54:function(e,t){e.exports={getCookie:function(e){var t=e+"=";if(!document)return"";for(var i=document.cookie.split(";"),n=0;n<i.length;n++){for(var r=i[n];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return""},debounce:function(e,t,i){var n;return function(){var r=this,o=arguments,a=function(){n=null,i||e.apply(r,o)},s=i&&!n;clearTimeout(n),n=setTimeout(a,t),s&&e.apply(r,o)}}}},66:function(e,t,i){var n=i(54),r=n.getCookie,o=n.debounce;e.exports={watch:function(e,t,i){var n=o(this.createVisibilityChangeHandler(e,t,i),250);window.addEventListener("DOMContentLoaded",n),window.addEventListener("load",n),window.addEventListener("scroll",n),window.addEventListener("resize",n),n()},slotIsVisible:function(e){return!document.hidden&&this.isElementInViewport(e)},isElementInViewport:function(e){var t=e.getBoundingClientRect(),i=t.width*t.height,n=window.innerWidth,r=window.innerHeight,o=n*r;return this.calculateOverlap(0,n,t.left,t.right)*this.calculateOverlap(0,r,t.top,t.bottom)>(.5-1e-7)*Math.min(i,o)},calculateOverlap:function(e,t,i,n){return Math.max(0,Math.min(t,n)-Math.max(e,i))},createVisibilityChangeHandler:function(e,t,i){var n=this;return function(){if(!e.shownSent&&n.slotIsVisible(e)){if(!e.timeout){var r=n.createSendShownEventHandler(e,t,i);e.timeout=window.setTimeout(r,1e3)}}else e.timeout&&(window.clearTimeout(e.timeout),delete e.timeout)}},createSendShownEventHandler:function(e,t,i){var n=this;return function(){var r="BUTTON"===e.tagName?n.getShowParamsButton(e):n.getShowParams(e);t.send("shown",r.shownId,{params:{cookie_id:r.ncgID,position:r.position,group_id:r.groupId,is_subscriber:i,category_name:r.categoryName?r.categoryName:""}}),e.shownSent=!0}},getShowParamsButton:function(e){var t=r("_ncg_id_"),i=e.dataset.order,n=e.parentNode.dataset.followedfromdomain,o=n&&n.split(".")[0],a=e.parentNode.dataset.facetid,s=e.getAttribute("data-group-id");return{ncgID:t,position:i,groupId:s?o+"_"+s:o+"_category-follow-recommendations",shownId:"",categoryName:a}},getShowParams:function(e){var t=e.href,i=t&&t.slice(Math.max(0,t.lastIndexOf("/")+1)),n=r("_ncg_id_"),o=e.hostname,a=o&&o.split(".")[1],s=e.getAttribute("data-tgev-order"),c=e.href.split("/")[3],d=e.getAttribute("data-tgev-container"),u=a+"_"+c;return e.getAttribute("data-group-id")&&(u=a+"_"+e.getAttribute("data-group-id")),"recommended-for-you"===d&&(u=a+"_recommended-for-you-"+newscorpau.pagetype),{ncgID:n,position:s,groupId:u,shownId:i}}}}});
//# sourceMappingURL=js-vidora-client.js.map